(function(){'use strict';function setupProtection(){$('#protection-details-link').qtip({style:{width:'280px',classes:'qtip-rounded qtip-shadow qtip-popup',tip:{corner:true,width:20,height:15}},position:{my:'top center',at:'bottom center'},content:$('#protection-details'),show:{event:'click',effect:function(){$(this).fadeIn(300);}},hide:{event:'unfocus click',fixed:true,effect:function(){$(this).fadeOut(300);}}});}
function setupTimezone(){var widget=$('#tz-selector-widget');widget.on('change','input[name=tz_mode]',function(){var customTZ=this.value==='custom';var customTZSelect=widget.find('select[name=tz]');customTZSelect.prop('disabled',!customTZ);if(customTZ){customTZSelect.focus();scrollToCurrentTZ();}});$('#tz-selector-link').qtip({style:{width:'300px',classes:'qtip-rounded qtip-shadow qtip-popup qtip-timezone',tip:{corner:true,width:20,height:15}},position:{my:'top center',at:'bottom center'},content:widget,show:{event:'click',effect:function(){$(this).fadeIn(300);}},hide:{event:'unfocus click',fixed:true,effect:function(){$(this).fadeOut(300);}},events:{show:function(){_.defer(scrollToCurrentTZ);}}});function scrollToCurrentTZ(){var option=widget.find('select[name=tz] option:selected')[0];if(option){option.scrollIntoView(false);}}}
function setupUserSettings(){var link=$('#user-settings-link');$('#user-settings-widget a:not([data-toggle=dropdown])').on('click',function(){link.qtip('hide');});link.qtip({style:{minWidth:'200px',classes:'qtip-rounded qtip-shadow qtip-popup qtip-allow-overflow',tip:{corner:true,width:20,height:15}},position:{my:'top center',at:'bottom center'},content:$('#user-settings-widget'),show:{event:'click',effect:function(){$(this).fadeIn(300);}},hide:{event:'unfocus click',fixed:true,effect:function(){$(this).fadeOut(300);}}});}
$(document).ready(function(){setupProtection();setupTimezone();setupUserSettings();});})();(function(){'use strict';function sendRequest(url,payload){$.ajax({url:url,method:'POST',data:payload,complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success:function(){IndicoUI.Dialogs.Util.progress();location.reload();}});}
function impersonateUser(url){function _userSelected(users){sendRequest(url,{user_id:users[0].id});}
var dialog=new ChooseUsersPopup($T("Select user to impersonate"),true,null,false,true,null,true,true,false,_userSelected,null,false);dialog.execute();}
function undoImpersonateUser(url){sendRequest(url,{undo:'1'});}
$(document).ready(function(){$('.login-as').on('click',function(evt){evt.preventDefault();impersonateUser($(this).data('href'));});$('.undo-login-as').on('click',function(evt){evt.preventDefault();undoImpersonateUser($(this).data('href'));});});})();