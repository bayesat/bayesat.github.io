(function(){'use strict';function setupEventDisplay(){function openAjaxDialog($element){ajaxDialog({title:$element.data('title'),url:$element.data('href'),confirmCloseUnsaved:true,onClose:function(data,customData){if(data||customData){location.reload();}}});}
$(document).on('click','[data-note-editor]',function(evt){evt.preventDefault();openAjaxDialog($(this));});$('.js-go-to-day').dropdown({always_listen:true}).find('li a').on('menu_select',function(){var anchor=$(this).attr('href');$('body, html').animate({scrollTop:$(anchor).offset().top},{duration:700,complete:function(){location.href=anchor;}});return false;});var selectors=['.notes-compile','.contribution-edit','.subcontribution-edit'].join(', ');$('body').on('click',selectors,function(e){e.preventDefault();openAjaxDialog($(this));return false;});$(document).ready(function(){$('h1, .item-description, .timetable-title').mathJax();});}
function toggleNote(element,visible,immediate){var note=element.closest('.event-note-section');if(note.length===0){note=element.closest('li').find('.note-area-wrapper');}
var content=note.hasClass('togglable')?note:note.find('.togglable');if(immediate){content.toggle(visible);}else{content[visible===undefined?'slideToggle':visible?'slideDown':'slideUp']();}}
$(document).ready(function(){$('.event-service-row > .trigger').on('click',function(){var toggler=$(this);toggler.siblings('.event-service-details').slideToggle({start:function(){toggler.toggleClass('icon-expand icon-collapse');},duration:'fast'});});$('.event-service-row-toggle').on('click',function(e){e.preventDefault();var toggler=$(this);var togglerButton=$(this).parent().siblings('.trigger');toggler.parent().siblings('.event-service-details').slideToggle({start:function(){togglerButton.toggleClass('icon-expand icon-collapse');},duration:'fast'});});var threeRowsHeight=70;$('.participant-list-wrapper').toggleClass('collapsible collapsed transparent-overlay',$('.participant-list').height()>threeRowsHeight);var initialHeight=$('.participant-list-wrapper').height();$('.participant-list-wrapper.transparent-overlay').on('click',function(){var toggler=$('.participant-list-wrapper > .trigger');var participantList=toggler.siblings('.participant-list');var wrapper=participantList.parent();if(wrapper.hasClass('collapsed')){var newHeight=participantList.height();participantList.height(initialHeight);wrapper.removeClass('collapsed transparent-overlay');wrapper.animate({height:newHeight},{duration:'fast',start:function(){toggler.addClass('icon-collapse').removeClass('icon-expand');},complete:function(){participantList.height(newHeight);}});}else{wrapper.addClass('transparent-overlay');wrapper.animate({height:initialHeight},{duration:'fast',start:function(){toggler.removeClass('icon-collapse').addClass('icon-expand');},complete:function(){wrapper.addClass('collapsed');}});}});$('a.js-show-note-toggle').on('click',function(e){e.preventDefault();toggleNote($(this));});$('input.js-toggle-note-cb').on('change',function(e,immediate){toggleNote($(this),this.checked,immediate);});$('input.js-toggle-note-cb').trigger('change',[true]);$('.js-note-editor').ajaxDialog({title:$T("Edit minutes"),confirmCloseUnsaved:true,onClose:function(data,customData){if(data||customData){location.reload();}}});setupEventDisplay();});})();(function(global){'use strict';function colorizeFilter(filter){var dropdown=filter.find('.dropdown');filter.toggleClass('active highlight',dropdown.find(':checked').length>0);}
function colorizeActiveFilters(){$('.list-filter .filter').each(function(){colorizeFilter($(this));});}
function setupStaticURLGeneration(){$('.js-static-url').on('click',function(){var $this=$(this);$.ajax({method:'POST',url:$this.data('href'),error:handleAjaxError,complete:IndicoUI.Dialogs.Util.progress(),success:function(data){$this.copyURLTooltip(data.url);}});});}
global.handleRowSelection=function(){$('table.i-table input.select-row').on('change',function(){$(this).closest('tr').toggleClass('selected',this.checked);$('.js-requires-selected-row').toggleClass('disabled',!$('.list input:checkbox:checked').length);}).trigger('change');};global.setupTableSorter=function(){$('.list .tablesorter').tablesorter({cssAsc:'header-sort-asc',cssDesc:'header-sort-desc',headerTemplate:'',headers:{0:{sorter:false}}});};global.setupListFilter=function(){var visibleItems=$('#visible-items');var hasColumnSelector=!!$('#visible-items').length;$('.list-filter .filter').each(function(){var $filter=$(this).parent();var isOnlyFilter=!!$filter.find('[data-only-filter]').length;$filter.dropdown({selector:"a[data-toggle='dropdown']",relative_to:$filter});if(!hasColumnSelector||isOnlyFilter){$filter.find('.title-wrapper').on('click',function(evt){$filter.find("a[data-toggle='dropdown']").trigger('click');evt.stopPropagation();});}});colorizeActiveFilters();$('.list-filter-dialog .toolbar').dropdown();$('.title-wrapper').on('click',function(evt){if($(evt.target).hasClass('filter')){return;}
var $this=$(this);var field=$this.closest('.title-wrapper');var fieldId=field.data('id');var visibilityIcon=field.find('.visibility');var enabled=visibilityIcon.hasClass('enabled');var isOnlyFilter=!!$this.parent().find('[data-only-filter]').length;if(hasColumnSelector&&!isOnlyFilter){var itemsData=JSON.parse(visibleItems.val());if(enabled){itemsData.splice(itemsData.indexOf(fieldId),1);}else{itemsData.push(fieldId);}
visibilityIcon.toggleClass('enabled',!enabled);field.toggleClass('striped',enabled);visibleItems.val(JSON.stringify(itemsData)).trigger('change');}});if(hasColumnSelector){$('.title-wrapper').each(function(){var field=$(this);var fieldId=field.data('id');var itemsData=JSON.parse(visibleItems.val());var isOnlyFilter=!!field.parent().find('[data-only-filter]').length;if(!isOnlyFilter){if(itemsData.indexOf(fieldId)!==-1){field.find('.visibility').addClass('enabled');}else{field.addClass('striped');}}});}
$('.js-reset-btn').on('click',function(){$('.list-filter input:checkbox:checked').prop('checked',false).trigger('change');$('.js-clear-filters-message').show({done:function(){var $this=$(this);setTimeout(function(){$this.slideUp();},4000);}});});$('.list-filter input:checkbox').on('change',function(){colorizeFilter($(this).closest('.filter'));});$('.list-filter .title').on('mouseover',function(){var title=$(this);if(this.offsetWidth<this.scrollWidth){title.qtip({hide:'mouseout',content:title.text(),overwrite:false}).qtip('show');}});$('#list-filter-select-all').on('click',function(){$('.list-filter-dialog .visibility:not(.enabled)').trigger('click');});$('#list-filter-select-none').on('click',function(){$('.list-filter-dialog .visibility.enabled').trigger('click');});};global.setupListGenerator=function(filterConfig){var applySearchFilters;if(filterConfig){applySearchFilters=setupSearchBox(filterConfig);}
setupStaticURLGeneration();handleRowSelection();setupTableSorter();$('.list').on('indico:htmlUpdated',function(){handleRowSelection();setupTableSorter();});$('.list .toolbar').dropdown();$('#select-all').on('click',function(){$('table.i-table input.select-row').prop('checked',true).trigger('change');});$('#select-none').on('click',function(){$('table.i-table input.select-row').prop('checked',false).trigger('change');});$('.change-columns-width').on('click',function(){$('.js-list-table-wrapper').toggleClass('scrollable');$('.change-columns-width').toggleClass('active');});$('.js-submit-list-form').on('click',function(e){e.preventDefault();var $this=$(this);if(!$this.hasClass('disabled')){$('.list form').attr('action',$this.data('href')).submit();}});$('.list .toolbar').on('click','.disabled',function(e){e.preventDefault();e.stopPropagation();});return applySearchFilters;};global.getSelectedRows=function(){return $('.list input:checkbox:checked').map(function(){return $(this).val();}).get();};})(window);(function(global){'use strict';var totalDurationDisplay;function formatState(visible,total){return'{0} / {1}'.format('<strong>{0}</strong>'.format(visible.length),total.length);}
function setState(state,visible,total){state.html($('<span>').append(formatState(visible,total)));state.attr('title',$T.gettext("{0} out of {1} displayed").format(visible.length,total.length));if(!totalDurationDisplay){totalDurationDisplay=$('#total-duration').detach();}}
function _applySearchFilters(searchBoxConfig){var $items=$(searchBoxConfig.listItems);var term=$(searchBoxConfig.term).val().trim();var $state=$(searchBoxConfig.state);var $visibleEntries,m;var $filterPlaceholder=$(searchBoxConfig.placeholder);$filterPlaceholder.hide();$state.removeClass('active');if(!term){$items.show();setState($state,$items,$items);if(totalDurationDisplay){$state.after(totalDurationDisplay);totalDurationDisplay=null;}
return;}
if((m=term.match(/^#(\d+)$/))){$visibleEntries=$items.filter('[data-friendly-id="'+m[1]+'"]');}else{$visibleEntries=$items.find('[data-searchable*="'+term.toLowerCase()+'"]').closest(searchBoxConfig.itemHandle);}
if($visibleEntries.length===0){$filterPlaceholder.text($T.gettext('There are no entries that match your search criteria.')).show();$state.addClass('active');}else if($visibleEntries.length!==$items.length){$state.addClass('active');}
setState($state,$visibleEntries,$items);$items.hide();$visibleEntries.show();$(window).trigger('scroll');}
global.setupSearchBox=function setupSearchBox(config){var applySearchFilters=_.partial(_applySearchFilters,config);$(config.term).realtimefilter({callback:applySearchFilters});applySearchFilters();return applySearchFilters;};})(window);(function(){'use strict';function injectFacebook(appId){$.getScript('//connect.facebook.net/en_US/all.js#xfbml=1',function(){FB.init({appId:appId,status:true,cookie:false,xfbml:true});FB.Event.subscribe('xfbml.render',function(){$('#fb-loading').hide();$('#fb-like').css('visibility','visible');});FB.XFBML.parse();});}
$(document).ready(function(){var container=$('.social-button-container');if(!container.length){return;}
var dark=container.data('dark-theme');$('.social-button').qtip({style:{width:'420px',classes:'qtip-rounded qtip-shadow social_share_tooltip '+(dark?'qtip-dark':'qtip-blue')},position:{my:'bottom right',at:'top center'},content:$('.social-share'),show:{event:'click',effect:function(){$(this).show('slide',{direction:'down'});},target:$('.social-button')},hide:{event:'unfocus click',fixed:true,effect:function(){$(this).fadeOut(300);}},events:{render:function(){injectFacebook($('.social-button-container').data('social-settings').facebook_app_id);$.getScript('//apis.google.com/js/plusone.js');$.getScript('//platform.twitter.com/widgets.js');},hide:function(){$('.social-button-container').css('opacity','');},show:function(){$('.social-button-container').css('opacity',1.0);}}});container.delay(250).fadeIn(1000);});})();